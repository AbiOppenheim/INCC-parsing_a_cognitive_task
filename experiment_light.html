<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/jspsych@7.3.3"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.2"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@1.1.2"></script>
  <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.2"></script>
  <script src="./jspsych/dist/plugin-survey-multi-choice.js"></script>
  <script src="./jspsych/dist/plugin-survey-text.js"></script>
  <script src="./jspsych/dist/plugin-fullscreen.js"></script>
  <script src="./jspsych/dist/plugin-audio-keyboard-response.js"></script>
  <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" type="text/css" />
  <script src="lib/jspsych/plugins/jspsych-key-sequence.js"></script>
</head>
<body></body>

<script>
  // Define the jsPsych timeline
      /* initialize jsPsych */
    var jsPsych = initJsPsych({
    // show_progress_bar: true,
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });
  var timeline = [];

  // Function to create a random trial
  function createRandomTrial() {
    var delay = jsPsych.randomization.randomInt(2600, 3000);
    var number = jsPsych.randomization.randomInt(21, 69);
    var audioFile = jsPsych.randomization.shuffle(['jspsych/examples/sound/speech_blue.mp3', 'jspsych/examples/sound/speech_red.mp3'])[0];
      

    var number_tone_task = {
      type: jsPsychAudioKeyboardResponse,
      stimulus: audioFile,
      prompt: `<p id="prompt" style="visibility:hidden;">${number}</p>`,
      choices: ['a','s'],
      on_load: function() {
        // wait for 3 seconds, then show the prompt
        setTimeout(function() {
          document.getElementById('prompt').style.visibility = "visible";
        }, delay);
      },
      data: {
        task: 'number_tone_task'
      }
    };

    return [delay, number, number_tone_task];
  }
  var fixation = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: "NO_KEYS",
      trial_duration: 200, // TODO: preguntar si utilizar separador y de cuanto
      data: {
        task: 'fixation'
      }
    };

  // Create a series of random trials
  for (var i = 0; i < 10; i++) { // Change 10 to the desired number of trials
    var randomTrial = createRandomTrial();
    console.log(randomTrial);
    timeline.push(randomTrial[2]);
    timeline.push(fixation);
  };
  jsPsych.run(timeline);

  </script>
</html>
